<!DOCTYPE html>
<html>
	<head>
		
		<meta charset="utf-8">
		<title>123</title>
		<style>
			html,body{
				width:100%;
				height:100%;
			}
			#test {
				position: fixed;
				top: 25%;
				left: 25%;
				width: 50%;
				height: 50%;
				border: 1px dashed #ccc;
			}
			canvas {
				margin: 10px;
				border: 1px solid #000;
			}
			
			
		</style>
	</head>
	<body>
		<!--<div id="test">-->
			<canvas id="myCanvas" >
				<p>You browser not support Canvas</p>
				
				
			</canvas>
		<!--</div>-->
		<script>
			var container = document.body//("test");
			var canvas = document.getElementById("myCanvas");
			var arrData = [10,24,15];
			
			var startH = 0,
				target = 19;
			if (canvas.getContext) {
				var ctx = canvas.getContext("2d"),
					W = canvas.width = container.scrollWidth * 0.95,
					H = canvas.height = container.scrollHeight * 0.95;
				
				var max,
					iY;
				
				max = Math.max.apply(null,arrData);
				iY = (H * 0.8) / acount(max) ;
				
				
				ctx.save();
				
				ctx.translate(W * 0.1, H * 0.95); // iY * 0.95
				
				ctx.strokeStyle = "#000000";
				
				ctx.beginPath();
				ctx.moveTo(10,0);
				ctx.lineTo(10,- H * 0.8); // / iY * 0.8
				
				ctx.moveTo(10,0);
				ctx.lineTo(W,0)
				ctx.closePath();
				ctx.stroke();
				
				
				var num = (acount(max) / 5);  		//不可省略
				
				var height =  (H * 0.8  / 5);		//不可省略
				for (var i = 1; i <= 5; i++) {
					
					ctx.beginPath();
					
					ctx.strokeStyle = "#c1c1c1";
				
					ctx.setLineDash([4,8])
					ctx.moveTo(10,-i * height);
					ctx.lineTo(W,-i * height);
					
					ctx.closePath();
					ctx.stroke();
					
					ctx.font = "14px Microsoft yahei";
					ctx.textBaseline = "middle";
					ctx.textAlign = "start";
					console.log(i * height)
					ctx.fillText(i * num , -30, -i * height);
					ctx.fill();
				}
				var timer = setTimeout(function drawRect(){
					
						var speed = (target - startH) * 0.2;
						if (startH < target - 1) {
							ctx.save();
							ctx.scale(1,iY);
							ctx.fillRect(40,0,50,-startH);
							ctx.restore();
							startH += speed;
				       		setTimeout(drawRect,40);
						}
						if (startH > target) {
							clearTimeout(timer)
						}
						
				},40)
				
				
				
			}
			
			function acount(num, power){
					var index = 0;
					if (!acount.index || power == undefined) {
						acount.index = 0;
					}
					acount.index++;
					index = acount.index;
					return Math.ceil(num / 10) > 10 ? acount(Math.ceil(num / 10), index) : Math.ceil(num / 10) * Math.pow(10, index);
				}
			
			
		</script>
		<script>
			var arr1 = [1,2,3,4,5,6],
				arr2 = [[1,2],[3,4],[5,6],[7,8]],
				arr3 = [[10,11,12],[13,14,15],[16,17,18]];
				
			function countArr(array){
				return array.reduce(function(acc, val){
					return acc.concat(Array.isArray(val) ? countArr(val) : val);
				},[])
			}
			
			
			
			
		</script>
	</body>	
</html>